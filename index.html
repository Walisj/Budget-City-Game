<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Build Your Budget City</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 0;
    }
    .building-btn {
      padding: 10px 20px;
      margin: 10px;
      border-radius: 10px;
      border: none;
      background: #4caf50;
      color: white;
      cursor: pointer;
    }
    .building-btn:hover {
      background: #45a049;
    }
    #city {
      margin-top: 30px;
      position: relative;
      height: 400px;
      border: 2px dashed #888;
      background: #d8f3dc;
    }
    .building {
      position: absolute;
      width: 60px;
      height: 60px;
      transition: transform 0.5s ease;
    }
    .sparkle {
      position: absolute;
      width: 30px;
      height: 30px;
      pointer-events: none;
      animation: sparkleMove 4s linear infinite;
    }
    @keyframes sparkleMove {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(-100px); opacity: 0; }
    }
    #summary {
      margin-top: 20px;
      font-size: 1em;
      color: #444;
    }
    #leaderboard {
      margin-top: 30px;
      border-top: 2px solid #ccc;
      padding-top: 10px;
    }
    #leaderboardTable {
      margin: auto;
      border-collapse: collapse;
      width: 80%;
    }
    #leaderboardTable th, #leaderboardTable td {
      border: 1px solid #999;
      padding: 8px;
    }
    #message {
      margin-top: 20px;
      font-size: 1.2em;
      font-weight: bold;
      color: red;
    }
    .funny-gif {
      width: 150px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h1>Build Your Budget City</h1>
  <p>Budget: RM<span id="budget">100</span> million</p>

  <div>
    <button class="building-btn" onclick="build('Hospital', 30, 'https://drive.google.com/uc?export=download&id=1UFdy-fCiPliRnsbuBDKzP4JhpjIMZajD')">Hospital (RM30M)</button>
    <button class="building-btn" onclick="build('Mall', 25, 'https://drive.google.com/uc?export=download&id=1Oy94c0BvSCrpO8fdhrV-P1zRDBKOlCe2')">Mall (RM25M)</button>
    <button class="building-btn" onclick="build('Park', 15, 'https://drive.google.com/uc?export=download&id=1BfYWH5vEtb7ZEHrY21DoEm1j3kEGGT7I')">Park (RM15M)</button>
    <button class="building-btn" onclick="build('Police', 20, 'https://drive.google.com/uc?export=download&id=1trVBPh9Obf5fyS-rhgf-Dm2vgFfuI14r')">Police (RM20M)</button>
    <button class="building-btn" onclick="build('School', 10, 'https://drive.google.com/uc?export=download&id=123o4Z0JEHZ7RY0Ck-QS096_LNR1PaVHW')">School (RM10M)</button>
  </div>

  <div id="city"></div>

  <div id="message"></div>
  <div id="summary"></div>

  <div id="leaderboard">
    <h2>Leaderboard</h2>
    <table id="leaderboardTable">
      <thead>
        <tr><th>Player</th><th>Total Spent (RM)</th></tr>
      </thead>
      <tbody id="leaderboardBody"></tbody>
    </table>
  </div>

  <script>
    let budget = 100;
    let buildings = [];
    let playerName = prompt("Enter your name:");
    let spent = 0;

    function build(name, cost, imageUrl) {
      if (budget < cost) {
        document.getElementById("message").innerHTML = "Uh oh! You're broke now ðŸ˜…<br><img src='https://media.giphy.com/media/3o6Zt481isNVuQI1l6/giphy.gif' class='funny-gif'>";
        return;
      }

      budget -= cost;
      spent += cost;
      buildings.push(name);
      document.getElementById("budget").innerText = budget;

      // Add image to map randomly
      const img = document.createElement("img");
      img.src = imageUrl;
      img.classList.add("building");
      img.style.top = Math.random() * 340 + "px";
      img.style.left = Math.random() * 90 + "%";
      document.getElementById("city").appendChild(img);

      // Add sparkle
      const sparkle = document.createElement("img");
      sparkle.src = "https://media.giphy.com/media/l4pTfx2qLszoacZRS/giphy.gif";
      sparkle.className = "sparkle";
      sparkle.style.left = Math.random() * 90 + "%";
      sparkle.style.top = Math.random() * 340 + "px";
      document.getElementById("city").appendChild(sparkle);

      // Summary update
      let summaryMsg = `You've built: ${buildings.join(", ")}.<br>`;
      if (budget === 0) summaryMsg += "Perfect planning!";
      else if (budget < 20) summaryMsg += "That was tight budgeting!";
      else summaryMsg += "You still have funds. Couldâ€™ve added more?";
      document.getElementById("summary").innerHTML = summaryMsg;

      updateLeaderboard();
    }

    function updateLeaderboard() {
      let stored = JSON.parse(localStorage.getItem("leaderboard")) || [];
      const existing = stored.find(entry => entry.name === playerName);
      if (existing) existing.spent = spent;
      else stored.push({ name: playerName, spent: spent });

      stored.sort((a, b) => a.spent - b.spent);
      localStorage.setItem("leaderboard", JSON.stringify(stored));

      const tbody = document.getElementById("leaderboardBody");
      tbody.innerHTML = "";
      stored.forEach(entry => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${entry.name}</td><td>${entry.spent}M</td>`;
        tbody.appendChild(row);
      });
    }

    window.onload = updateLeaderboard;
  </script>
</body>
</html>
